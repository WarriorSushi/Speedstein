{
  "permissions": {
    "allow": [
      "Bash(git fetch:*)",
      "SlashCommand(/speckit.constitution Create a constitution for Speedstein, a high-performance PDF generation API. if exisiting constitution markdown is present in memory folder, alter its content according to the already present skeleton\n\nCORE PRINCIPLES:\n\n1. PERFORMANCE FIRST (NON-NEGOTIABLE)\n   - All PDFs must generate in under 2 seconds (P95 latency)\n   - Browser session reuse is mandatory for performance\n   - Promise pipelining must be used for batch operations\n   - No cold starts - keep Chrome instances warm\n\n2. SECURITY & AUTHENTICATION\n   - All API keys MUST be SHA-256 hashed before storage\n   - Never store plaintext API keys\n   - Row Level Security (RLS) must be enabled on all Supabase tables\n   - Rate limiting is mandatory on all API endpoints\n   - CORS must be properly configured\n\n3. DESIGN SYSTEM STANDARDS (NON-NEGOTIABLE)\n   - ONLY use OKLCH color space - never RGB, HSL, or hex colors\n   - All colors must be perceptually uniform for accessibility\n   - WCAG AAA contrast compliance is mandatory\n   - Elevation system uses OKLCH lightness manipulation only\n   - shadcn/ui components exclusively - no other UI libraries\n\n4. TECHNOLOGY STACK CONSTRAINTS\n   - Frontend: Next.js 15 with App Router (mandatory)\n   - Backend: Cloudflare Workers (mandatory)\n   - RPC: Cap'n Web for all PDF generation (mandatory)\n   - Database: Supabase with RLS policies (mandatory)\n   - Payments: DodoPayments (mandatory)\n   - Styling: Tailwind CSS with OKLCH tokens (mandatory)\n\n5. CODE QUALITY\n   - TypeScript strict mode required\n   - All functions must have proper error handling\n   - No console.log in production code\n   - Zod schemas for all API validation\n   - Proper resource disposal for browser instances\n\n6. CAP'N WEB BEST PRACTICES (CRITICAL)\n   - Always extend RpcTarget for server-side classes\n   - Use promise pipelining for dependent operations\n   - Dispose resources properly with 'using' keyword\n   - Keep WebSocket sessions alive with heartbeats\n   - Never block the event loop in RPC methods\n\n7. USER EXPERIENCE\n   - Landing page must load in under 2 seconds\n   - Live demo must work without signup\n   - Dark mode support is mandatory\n   - Mobile-responsive design required\n   - Lighthouse score must be 95+ on all pages\n\n8. TESTING & QUALITY\n   - Unit tests for critical business logic\n   - Integration tests for API endpoints\n   - E2E tests for user flows (signup, generate PDF)\n   - 80%+ code coverage target\n   - No broken links or 404 errors\n\n9. DOCUMENTATION\n   - All API endpoints must be documented\n   - Code examples in JavaScript, Python, PHP, Ruby\n   - README with setup instructions\n   - Inline comments for complex logic\n\n10. DEPLOYMENT & OPERATIONS\n    - Zero-downtime deployments\n    - Error tracking with Sentry\n    - Uptime monitoring with 99.9% SLA\n    - Proper logging for debugging\n    - Environment variables for all secrets\n\nGOVERNANCE:\n- Constitution supersedes all other practices\n- Deviations require explicit documentation and approval\n- All PRs must verify compliance with these principles\n- Performance regressions are blocking issues\n- Security issues are critical priority\n\nREFERENCE DOCUMENTS:\nThe following markdown files in this directory contain detailed technical specifications and must be consulted during planning and implementation:\n- SPEEDSTEIN_TECHNICAL_SPEC.md\n- SPEEDSTEIN_API_REFERENCE.md\n- SPEEDSTEIN_IMPLEMENTATION_PLAN.md\n- SPEEDSTEIN_TECHSTACK.md)",
      "SlashCommand(/speckit.constitution:*)",
      "Bash(if [ -d \"specs\" ])",
      "Bash(then ls -1 specs)",
      "Bash(else echo \"No specs directory\")",
      "Bash(fi)",
      "Bash(powershell.exe -File:*)",
      "Bash(if [ -d \"C:/coding/speedstein/specs/001-pdf-api-platform/checklists\" ])",
      "Bash(then ls -1 \"C:/coding/speedstein/specs/001-pdf-api-platform/checklists\")",
      "Bash(else echo \"No checklists directory\")",
      "Bash(git rev-parse:*)",
      "Bash(pnpm:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(supabase --version:*)",
      "Bash(docker:*)",
      "Bash(supabase init:*)",
      "Bash(mkdir:*)",
      "Bash(cp:*)",
      "Bash(supabase start:*)",
      "Bash(supabase db reset:*)",
      "Bash(supabase link:*)",
      "Bash(supabase login:*)",
      "Bash(export SUPABASE_ACCESS_TOKEN=\"sbp_9be882b48b79c61f03eac6c8ccf757fc728bfca0\")",
      "Bash(supabase db push:*)",
      "Bash(cat:*)",
      "Bash(supabase status:*)",
      "Bash(test:*)",
      "Read(//c/**)",
      "Bash(npx wrangler whoami)",
      "Bash(npx wrangler:*)",
      "Bash(curl:*)",
      "Bash(npx dotenv:*)",
      "Bash(set SUPABASE_URL:*)",
      "Bash(set SUPABASE_SERVICE_ROLE_KEY:*)",
      "SlashCommand(/speckit.analyze)",
      "Bash(if [ -d \".specify/specs\" ])",
      "Bash(then ls -1 .specify/specs)",
      "Bash(then ls -d specs/*-architecture-alignment)",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/create-new-feature.ps1 -Json -Number 2 -ShortName \"architecture-alignment\" \"Fix critical architecture gaps: implement Durable Objects for browser session pooling, Cap''n Web RPC with promise pipelining, correct pricing tiers, and R2 storage lifecycle policies\")",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/setup-plan.ps1 -Json)",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/check-prerequisites.ps1 -Json)",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/check-prerequisites.ps1 -Json -RequireTasks -IncludeTasks)",
      "Bash(if [ -d \"C:/coding/speedstein/specs/002-architecture-alignment/checklists\" ])",
      "Bash(then ls -1 \"C:/coding/speedstein/specs/002-architecture-alignment/checklists\")",
      "Bash(find:*)",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/create-new-feature.ps1 -Json -Number 3 -ShortName \"production-readiness\" \"Fix critical production blockers: database schema creation, R2 storage integration, crypto bug fixes, Enterprise quota correction, and frontend initialization for MVP launch\")",
      "Bash(if [ -d \"C:/coding/speedstein/specs/003-production-readiness/checklists\" ])",
      "Bash(then ls -1 \"C:/coding/speedstein/specs/003-production-readiness/checklists\")",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/update-agent-context.ps1 -AgentType claude)",
      "Bash(node --version:*)",
      "Bash(supabase migration repair:*)",
      "Bash(supabase migration:*)",
      "Bash(supabase db remote exec:*)",
      "Bash(supabase inspect:*)",
      "Bash(supabase db pull:*)",
      "Bash(node scripts/test-database.mjs:*)",
      "Bash(powershell.exe -Command \"$devVars = Get-Content apps/worker/.dev.vars; foreach ($line in $devVars) { if ($line -match ''^SUPABASE_URL=(.+)$'') { $env:SUPABASE_URL = $matches[1] }; if ($line -match ''^SUPABASE_SERVICE_ROLE_KEY=(.+)$'') { $env:SUPABASE_SERVICE_ROLE_KEY = $matches[1] } }; node scripts/generate-test-api-key-fixed.mjs\")",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File scripts/generate-test-key.ps1)",
      "Bash(export SUPABASE_URL:*)",
      "Bash(export SUPABASE_SERVICE_ROLE_KEY:*)",
      "Bash(node scripts/generate-test-api-key-fixed.mjs:*)",
      "Bash(export TEST_API_KEY=\"sk_test_E_wGc6O3HC6UUVUwuvMZoaj8qTYUHsgJK2h2uoRumBU\")",
      "Bash(node scripts/test-api-e2e.mjs:*)",
      "Bash(start speedstein-success.pdf)",
      "Bash(start speedstein-demo.pdf)",
      "Bash(git restore:*)",
      "Bash(else echo \"0\")",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/create-new-feature.ps1 -Json -Number 4 -ShortName \"architecture-alignment\" \"Fix critical architecture gaps: implement Durable Objects for browser session pooling, Cap''n Web RPC with promise pipelining, correct pricing tiers, and R2 storage lifecycle policies\")",
      "SlashCommand(/speckit.plan)",
      "SlashCommand(/speckit.tasks)",
      "Bash(if [ -d \"C:/coding/speedstein/specs/004-architecture-alignment/checklists\" ])",
      "Bash(then ls -1 \"C:/coding/speedstein/specs/004-architecture-alignment/checklists\")",
      "Bash(timeout 10 pnpm tsc:*)",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/create-new-feature.ps1 -Json -Number 5 -ShortName \"constitution-compliance\" \"Complete all missing constitution requirements: frontend with OKLCH design system and shadcn/ui, DodoPayments integration, authentication UI flows, comprehensive testing infrastructure, performance validation, and architecture fixes for browser session management and R2 storage integration\")",
      "Bash(if [ -d \"C:/coding/speedstein/specs/005-constitution-compliance/checklists\" ])",
      "Bash(then ls -1 \"C:/coding/speedstein/specs/005-constitution-compliance/checklists\")",
      "Bash(npx shadcn@latest init)",
      "Bash(npx shadcn@latest add:*)",
      "Bash(npx playwright install chromium)",
      "Bash(ls:*)",
      "Bash(grep:*)",
      "Bash(powershell.exe -Command \"$env:SUPABASE_URL=''https://czvvgfprjlkahobgncxo.supabase.co''; $env:SUPABASE_SERVICE_ROLE_KEY=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN6dnZnZnByamxrYWhvYmduY3hvIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MTQxMDg3NiwiZXhwIjoyMDc2OTg2ODc2fQ.JWZ1OTMxArR1pwA848HDV1it2WItdJHfHgcU0ugH5Vw''; node scripts/generate-test-api-key-fixed.mjs\")",
      "Bash(start final-test.pdf)",
      "Bash(time curl:*)",
      "Bash(start success-test.pdf)",
      "Bash(for:*)",
      "Bash(do echo \"=== Test $i ===\")",
      "Bash(done)",
      "Bash(do echo \"=== REST Test $i ===\")",
      "Bash(do echo \"=== OPTIMIZED Test $i ===\")",
      "Bash(powershell.exe -ExecutionPolicy Bypass -File .specify/scripts/powershell/create-new-feature.ps1 -Json -Number 6 -ShortName \"launch-readiness\" \"Complete all critical missing components identified in specification compliance analysis: Priority 1 BLOCKING items (Authentication & Dashboard Phase 3, Payment Integration Phase 6, Monitoring Phase 9), Priority 2 HIGH RISK items (E2E Testing Phase 8, Documentation), and Priority 3 items (OKLCH Design System completion, Performance Optimization). This represents 70% of the 50-step implementation plan that was skipped, comprising Phases 3, 5, 6, 7, 8, 9, and 10.\")",
      "Bash(npx playwright install:*)",
      "Bash(openssl rand:*)",
      "Bash(npx:*)",
      "Bash(if [ -d \"C:/coding/speedstein/specs/006-launch-readiness/checklists\" ])",
      "Bash(then ls -1 \"C:/coding/speedstein/specs/006-launch-readiness/checklists\")",
      "Bash(timeout 30 pnpm tsc:*)",
      "Bash(xargs sed:*)",
      "Bash(timeout 20 pnpm next build:*)",
      "Bash(timeout 20 pnpm tsc:*)",
      "Bash(timeout 30 pnpm build:*)",
      "Bash(timeout 40 pnpm build:*)",
      "Bash(timeout 45 pnpm build:*)",
      "Bash(timeout 120 pnpm build:*)",
      "Bash(git log:*)",
      "Bash(git rm:*)",
      "SlashCommand(/speckit.implement)",
      "Bash(if [ -f \"Dockerfile\" ])",
      "Bash(then echo \"Dockerfile exists\")",
      "Bash(else echo \"No Dockerfile\")",
      "Bash(generates the pdf\" and \"show users tht this is our tech and how much afsater)",
      "Bash(it is compared to others. and we also tell hwo it compounds when more pdfs)",
      "Bash(are being gnereated.\"\n\nRelated: Constitution Principle VI (Cap''n Web best practices)\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")"
    ],
    "deny": [],
    "ask": []
  }
}
