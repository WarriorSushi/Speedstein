name = "speedstein-worker"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

[env.production]
name = "speedstein-worker-production"
route = "api.speedstein.com/*"

[env.staging]
name = "speedstein-worker-staging"

[[kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "22a4d1624e4848ed9fdcc541bcf7ab39"  # speedstein-rate-limit-dev
preview_id = "c7c30649626b482bbd08001d64b0f8ea"  # speedstein-rate-limit-preview

[[r2_buckets]]
binding = "PDF_STORAGE"
bucket_name = "speedstein-pdfs-dev"
preview_bucket_name = "speedstein-pdfs-preview"
# Jurisdiction-specific endpoint: https://d0bd6c8419b815cd8b9ce41f5175b29e.r2.cloudflarestorage.com
# Credentials in .dev.vars for local development (R2_ACCESS_KEY_ID, R2_SECRET_ACCESS_KEY)

[browser]
binding = "BROWSER"

[[durable_objects.bindings]]
name = "BROWSER_POOL_DO"
class_name = "BrowserPoolDO"

# Durable Objects migrations (required for deployment)
[[migrations]]
tag = "v1"
new_classes = ["BrowserPoolDO"]
